var app=angular.module("emailMarketingApp",["ngRoute","toaster","angularSpinner"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/formulario",{templateUrl:"views/formulario.html",controller:"FormularioController"}).when("/end",{templateUrl:"views/end.html",controller:"EndController"}).when("/unsubscribe",{templateUrl:"views/unsubscribe.html",controller:"UnsubscribeController"}).otherwise({redirectTo:"/formulario"})}]),app.factory("Config",function(){var a="http://agilesolutions.com:8080/";return{base_url:a,endpoints:{questionario:"questionario/",unsubscribe:"questionario/unsubscribe/"}}}),app.controller("EndController",["$scope","$http","$routeParams","$location","Config",function(a,b,c,d,e){function f(a,b,c,d,e,f,g,h){var i=angular.element(a+" canvas")[0];if(i.getContext){var j=i.getContext("2d");j.beginPath(),j.moveTo(b,e),j.lineTo(c,f),j.lineTo(d,g),j.closePath(),j.fillStyle=h,j.strokeStyle=h,j.stroke(),j.fill()}}f(".triangle.header",0,60,120,0,60,0,"#425aa6"),f(".triangle.footer",0,60,120,150,90,150,"#10172e")}]),app.controller("FormularioController",["$scope","$http","$routeParams","$location","Config","toaster","usSpinnerService",function(a,b,c,d,e,f,g){function h(a,b,c,d,e,f,g,h){var i=angular.element(a+" canvas")[0];if(i.getContext){var j=i.getContext("2d");j.beginPath(),j.moveTo(b,e),j.lineTo(c,f),j.lineTo(d,g),j.closePath(),j.fillStyle=h,j.fill()}}function i(){return""==a.nomeCliente?(k("O campo nome é obrigatório"),!1):""==a.sobrenomeCliente?(k("O campo sobrenome é obrigatório"),!1):""==a.empresaCliente?(k("O campo empresa é obrigatório"),!1):""==a.cargoCliente?(k("O campo cargo é obrigatório"),!1):m.test(a.emailCliente)?""==a.telefoneCliente?(k("O campo telefone é obrigatório"),!1):""==a.question1.finalAnswer?(k("Responda a questão 1"),!1):0==l().length?(k("Selecione pelo menos um item na questão 2"),!1):""==a.question3.finalAnswer?(k("Responda a questão 3"),!1):!0:(k("O campo email deve conter um email válido"),!1)}function j(){a.question1={question:"Qual é o seu papel no processo de decisão da sua empresa?",answers:["Eu decido","Eu influencio nas decisões","Eu não me envolvo nas decisões"],finalAnswer:""},a.question2=[{name:"Demandas de Software Tributário e Fiscal",selected:!1,subQuestionslevel2:[{name:"Tax Declaration Framework (SAP TDF)",selected:!1},{name:"SAP TAX Intelligence and Management Platform by ALLTAX",selected:!1}]},{name:"SAP S/4 HANA",selected:!1,subQuestionslevel2:[{name:"Implementação S/4 HANA",selected:!1},{name:"Migração SAP ERP para S/4 HANA",selected:!1},{name:"Migração SAP ERP para Nuvem",selected:!1},{name:"S/4 HANA Finance",selected:!1},{name:"RDS S/4 HANA",selected:!1},{name:"Projetos sob demanda utilizando SAP HANA",selected:!1},{name:"Business Intelligence",selected:!1},{name:"Orçamento e Planejamento",selected:!1}]},{name:"Agrobusiness",selected:!1,subQuestionslevel2:[{name:"Solução Integral Agro (AgroBiz)",selected:!1},{name:"Laboratório de Qualidade Agrícola (AQM)",selected:!1},{name:"Portal de Fornecedores Agrícola (ASM)",selected:!1},{name:"Balança",selected:!1},{name:"Mobilidade para Agronegócio",selected:!1},{name:"GIS",selected:!1}]},{name:"Outros",selected:!1,subQuestionslevel2:[{name:"Internet of Things (IoT)",selected:!1},{name:"Mapeamento Integral dos Consumidores (Cunsumer Insight 365)",selected:!1},{name:"Projeto Florestal",selected:!1},{name:"Alinhamento da estratégia de Negócio com TI",selected:!1},{name:"Suporte, melhorias e recursos (AMS)",selected:!1}]}],a.question3={question:"Autorizo a AGILE a utilizar a informação aqui declarada para o desenvolvimento de campanhas de mercado, convites a eventos, atualizações de base de dados e para futuros contatos comerciais.",answers:["Sim","Não"],finalAnswer:""}}function k(a){f.pop({type:"error",title:a})}function l(){var b=[];return angular.forEach(a.question2,function(a){a.selected&&b.push(a.name),angular.forEach(a.subQuestionslevel2,function(a){a.selected&&b.push(a.name)})}),b}var m=/^[_a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,4})$/;j(),a.nomeCliente="",a.sobrenomeCliente="",a.empresaCliente="",a.cargoCliente="",a.emailCliente="",a.telefoneCliente="",h(".triangle.header",0,60,120,0,60,0,"#3ea9de"),h(".triangle.footer",0,60,120,150,90,150,"#10172e"),a.saveFormulario=function(){if(i()){var c={nome:a.nomeCliente,sobrenome:a.sobrenomeCliente,empresa:a.empresaCliente,cargo:a.cargoCliente,email:a.emailCliente,telefone:a.telefoneCliente,perguntas:{p1:a.question1.finalAnswer,p2:l(),p3:a.question3.finalAnswer}};angular.element(".loader").show(),b.post(e.base_url+e.endpoints.questionario,c).then(function(a){angular.element(".loader").hide(),d.path("/end")},function(a){angular.element(".loader").hide(),-1!=a.data.message.indexOf("Duplicate entry")&&k("Email já cadastrado")})}}}]),app.controller("UnsubscribeController",["$scope","$http","$routeParams","$location","Config","toaster","$timeout",function(a,b,c,d,e,f,g){a.unscribeClick=function(){var c={email:a.email};b.post(e.base_url+e.endpoints.unsubscribe,c).then(function(a){f.pop({type:"success",title:"Email descadastrado com sucesso"}),angular.element(".loader").hide(),g(function(){window.location.href="http://www.agilesolutions.com"},2e3)},function(a){angular.element(".loader").hide(),-1!=a.data.message.indexOf("Duplicate entry")&&f.pop({type:"error",title:"Email já foi descadastrado"})})}}]);